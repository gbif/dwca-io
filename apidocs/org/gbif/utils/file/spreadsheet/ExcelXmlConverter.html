<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_141) on Wed Jul 04 14:40:05 CEST 2018 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>ExcelXmlConverter (Darwin Core Archive IO Library 2.1-SNAPSHOT API)</title>
<meta name="date" content="2018-07-04">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="ExcelXmlConverter (Darwin Core Archive IO Library 2.1-SNAPSHOT API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":9,"i1":10,"i2":10};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ExcelXmlConverter.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/gbif/utils/file/spreadsheet/ExcelConverter.html" title="class in org.gbif.utils.file.spreadsheet"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../org/gbif/utils/file/spreadsheet/IsoDateDataFormatter.html" title="class in org.gbif.utils.file.spreadsheet"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/gbif/utils/file/spreadsheet/ExcelXmlConverter.html" target="_top">Frames</a></li>
<li><a href="ExcelXmlConverter.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.gbif.utils.file.spreadsheet</div>
<h2 title="Class ExcelXmlConverter" class="title">Class ExcelXmlConverter</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>org.gbif.utils.file.spreadsheet.ExcelXmlConverter</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <a href="../../../../../src-html/org/gbif/utils/file/spreadsheet/ExcelXmlConverter.html#line.83">ExcelXmlConverter</a>
extends <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></pre>
<div class="block">An XLSX â†’ CSV processor, which is a copy of <a href="https://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/xssf/eventusermodel/XLSX2CSV.java">ExcelXmlConverter.java</a>
 modified to choose a particular sheet and output to a <a href="http://docs.oracle.com/javase/8/docs/api/java/io/Writer.html?is-external=true" title="class or interface in java.io"><code>Writer</code></a>. Dates are formatted to ISO 8601 standard,
 otherwise the formats defined in Excel are used.
 <p>
 The SAX parser should keep memory usage low, so large workbooks can be handled.
 <p>
 Original JavaDoc follows:
 <p>
 A rudimentary XLSX -> CSV processor modeled on the
 POI sample program XLS2CSVmra from the package
 org.apache.poi.hssf.eventusermodel.examples.
 As with the HSSF version, this tries to spot missing
  rows and cells, and output empty entries for them.
 <p>
 Data sheets are read using a SAX parser to keep the
 memory footprint relatively small, so this should be
 able to read enormous workbooks.  The styles table and
 the shared-string table must be kept in memory.  The
 standard POI styles table class is used, but a custom
 (read-only) class is used for the shared string table
 because the standard POI SharedStringsTable grows very
 quickly with the number of unique strings.
 <p>
 For a more advanced implementation of SAX event parsing
 of XLSX files, see <code>XSSFEventBasedExcelExtractor</code>
 and <code>XSSFSheetXMLHandler</code>. Note that for many cases,
 it may be possible to simply use those with a custom
 <code>XSSFSheetXMLHandler.SheetContentsHandler</code> and no SAX code needed of
 your own!</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../org/gbif/utils/file/spreadsheet/ExcelXmlConverter.html#ExcelXmlConverter-org.apache.poi.openxml4j.opc.OPCPackage-org.gbif.utils.file.spreadsheet.SpreadsheetConsumer-">ExcelXmlConverter</a></span>(org.apache.poi.openxml4j.opc.OPCPackage&nbsp;pkg,
                 <a href="../../../../../org/gbif/utils/file/spreadsheet/SpreadsheetConsumer.html" title="interface in org.gbif.utils.file.spreadsheet">SpreadsheetConsumer</a>&nbsp;writer)</code>
<div class="block">Creates a new XLSX -> CSV examples</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>static long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/gbif/utils/file/spreadsheet/ExcelXmlConverter.html#convert-java.nio.file.Path-org.gbif.utils.file.spreadsheet.SpreadsheetConsumer-">convert</a></span>(<a href="http://docs.oracle.com/javase/8/docs/api/java/nio/file/Path.html?is-external=true" title="class or interface in java.nio.file">Path</a>&nbsp;workbookFile,
       <a href="../../../../../org/gbif/utils/file/spreadsheet/SpreadsheetConsumer.html" title="interface in org.gbif.utils.file.spreadsheet">SpreadsheetConsumer</a>&nbsp;writer)</code>
<div class="block">Convert a workbook (.xlsx format) to some other format like CSV.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/gbif/utils/file/spreadsheet/ExcelXmlConverter.html#process--">process</a></span>()</code>
<div class="block">Initiates the processing of the XLS workbook file to CSV.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/gbif/utils/file/spreadsheet/ExcelXmlConverter.html#processSheet-org.apache.poi.xssf.model.StylesTable-org.apache.poi.xssf.eventusermodel.ReadOnlySharedStringsTable-org.apache.poi.xssf.eventusermodel.XSSFSheetXMLHandler.SheetContentsHandler-java.io.InputStream-">processSheet</a></span>(org.apache.poi.xssf.model.StylesTable&nbsp;styles,
            org.apache.poi.xssf.eventusermodel.ReadOnlySharedStringsTable&nbsp;strings,
            org.apache.poi.xssf.eventusermodel.XSSFSheetXMLHandler.SheetContentsHandler&nbsp;sheetHandler,
            <a href="http://docs.oracle.com/javase/8/docs/api/java/io/InputStream.html?is-external=true" title="class or interface in java.io">InputStream</a>&nbsp;sheetInputStream)</code>
<div class="block">Parses and shows the content of one sheet
 using the specified styles and shared-strings tables.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang">equals</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="class or interface in java.lang">hashCode</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#toString--" title="class or interface in java.lang">toString</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="ExcelXmlConverter-org.apache.poi.openxml4j.opc.OPCPackage-org.gbif.utils.file.spreadsheet.SpreadsheetConsumer-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>ExcelXmlConverter</h4>
<pre>public&nbsp;<a href="../../../../../src-html/org/gbif/utils/file/spreadsheet/ExcelXmlConverter.html#line.241">ExcelXmlConverter</a>(org.apache.poi.openxml4j.opc.OPCPackage&nbsp;pkg,
                         <a href="../../../../../org/gbif/utils/file/spreadsheet/SpreadsheetConsumer.html" title="interface in org.gbif.utils.file.spreadsheet">SpreadsheetConsumer</a>&nbsp;writer)</pre>
<div class="block">Creates a new XLSX -> CSV examples</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>pkg</code> - The XLSX package to process</dd>
<dd><code>writer</code> - The writer to output to</dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="convert-java.nio.file.Path-org.gbif.utils.file.spreadsheet.SpreadsheetConsumer-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>convert</h4>
<pre>public static&nbsp;long&nbsp;<a href="../../../../../src-html/org/gbif/utils/file/spreadsheet/ExcelXmlConverter.html#line.96">convert</a>(<a href="http://docs.oracle.com/javase/8/docs/api/java/nio/file/Path.html?is-external=true" title="class or interface in java.nio.file">Path</a>&nbsp;workbookFile,
                           <a href="../../../../../org/gbif/utils/file/spreadsheet/SpreadsheetConsumer.html" title="interface in org.gbif.utils.file.spreadsheet">SpreadsheetConsumer</a>&nbsp;writer)
                    throws <a href="http://docs.oracle.com/javase/8/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a>,
                           <a href="http://docs.oracle.com/javase/8/docs/api/org/xml/sax/SAXException.html?is-external=true" title="class or interface in org.xml.sax">SAXException</a>,
                           org.apache.poi.openxml4j.exceptions.OpenXML4JException</pre>
<div class="block">Convert a workbook (.xlsx format) to some other format like CSV.

 Example: ExcelXmlConverter.convert(xlsxPath, new CsvSpreadsheetConsumer(new FileWriter(outputCsvFile)));</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>workbookFile</code> - Path to the workbook file</dd>
<dd><code>writer</code> - A writer which will be given many List<String>s</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/8/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd>
<dd><code>org.apache.poi.openxml4j.exceptions.InvalidFormatException</code> - Thrown if invalid XML is found whilst parsing an input SpreadsheetML file.</dd>
<dd><code><a href="http://docs.oracle.com/javase/8/docs/api/org/xml/sax/SAXException.html?is-external=true" title="class or interface in org.xml.sax">SAXException</a></code></dd>
<dd><code>org.apache.poi.openxml4j.exceptions.OpenXML4JException</code></dd>
</dl>
</li>
</ul>
<a name="processSheet-org.apache.poi.xssf.model.StylesTable-org.apache.poi.xssf.eventusermodel.ReadOnlySharedStringsTable-org.apache.poi.xssf.eventusermodel.XSSFSheetXMLHandler.SheetContentsHandler-java.io.InputStream-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>processSheet</h4>
<pre>public&nbsp;long&nbsp;<a href="../../../../../src-html/org/gbif/utils/file/spreadsheet/ExcelXmlConverter.html#line.259">processSheet</a>(org.apache.poi.xssf.model.StylesTable&nbsp;styles,
                         org.apache.poi.xssf.eventusermodel.ReadOnlySharedStringsTable&nbsp;strings,
                         org.apache.poi.xssf.eventusermodel.XSSFSheetXMLHandler.SheetContentsHandler&nbsp;sheetHandler,
                         <a href="http://docs.oracle.com/javase/8/docs/api/java/io/InputStream.html?is-external=true" title="class or interface in java.io">InputStream</a>&nbsp;sheetInputStream)
                  throws <a href="http://docs.oracle.com/javase/8/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a>,
                         <a href="http://docs.oracle.com/javase/8/docs/api/org/xml/sax/SAXException.html?is-external=true" title="class or interface in org.xml.sax">SAXException</a></pre>
<div class="block">Parses and shows the content of one sheet
 using the specified styles and shared-strings tables.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>styles</code> - The table of styles that may be referenced by cells in the sheet</dd>
<dd><code>strings</code> - The table of strings that may be referenced by cells in the sheet</dd>
<dd><code>sheetInputStream</code> - The stream to read the sheet-data from.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/8/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - An IO exception from the parser,
      possibly from a byte stream or character stream
      supplied by the application.</dd>
<dd><code><a href="http://docs.oracle.com/javase/8/docs/api/org/xml/sax/SAXException.html?is-external=true" title="class or interface in org.xml.sax">SAXException</a></code> - if parsing the XML data fails.</dd>
</dl>
</li>
</ul>
<a name="process--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>process</h4>
<pre>public&nbsp;long&nbsp;<a href="../../../../../src-html/org/gbif/utils/file/spreadsheet/ExcelXmlConverter.html#line.280">process</a>()
             throws <a href="http://docs.oracle.com/javase/8/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a>,
                    org.apache.poi.openxml4j.exceptions.OpenXML4JException,
                    <a href="http://docs.oracle.com/javase/8/docs/api/org/xml/sax/SAXException.html?is-external=true" title="class or interface in org.xml.sax">SAXException</a></pre>
<div class="block">Initiates the processing of the XLS workbook file to CSV.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/8/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - If reading the data from the package fails.</dd>
<dd><code><a href="http://docs.oracle.com/javase/8/docs/api/org/xml/sax/SAXException.html?is-external=true" title="class or interface in org.xml.sax">SAXException</a></code> - if parsing the XML data fails.</dd>
<dd><code>org.apache.poi.openxml4j.exceptions.OpenXML4JException</code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ExcelXmlConverter.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/gbif/utils/file/spreadsheet/ExcelConverter.html" title="class in org.gbif.utils.file.spreadsheet"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../org/gbif/utils/file/spreadsheet/IsoDateDataFormatter.html" title="class in org.gbif.utils.file.spreadsheet"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/gbif/utils/file/spreadsheet/ExcelXmlConverter.html" target="_top">Frames</a></li>
<li><a href="ExcelXmlConverter.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2018 <a href="http://www.gbif.org">Global Biodiversity Information Facility</a>. All rights reserved.</small></p>
</body>
</html>